<div class="anchor" [@entry]="entryState" (@entry.done)="animationProgress()" [ngStyle]="{ top: coordinates.y + 'px', left: coordinates.x + 'px' }">
  <div
    class="container"
    [ngStyle]="{ width: viewport.width - coordinates.x + 'px', 'flex-direction': reverseDirection ? 'row-reverse' : 'row', 'flex-wrap': reverseWrap ? 'wrap-reverse' : 'wrap' }"
  >
    <div
      class="train"
      [@shake]="shakeState"
      (@shake.done)="shakeState = +shakeState + 1 === shakeKeyframes ? 0 : +shakeState + 1"
      [ngStyle]="{
        width: (size.width * (scale || 100)) / 100 + 'px',
        height: (size.height * (scale || 100)) / 100 + 'px',
        'background-image': backgroundPic ? 'url(' + backgroundPic + '#)' : ''
      }"
    >
      <img
        class="picture"
        [src]="user.picture"
        [ngStyle]="{
          top: _pictureBounds.top + 'px',
          width: _pictureBounds.width + 'px',
          left: _pictureBounds.left + 'px',
          height: _pictureBounds.height + 'px'
        }"
      />
      <div
        class="top"
        [ngStyle]="{
          top: (pictureBounds.top! * scale) / 100 + 'px',
          width: (pictureBounds.width! * scale) / 100 + 'px',
          left: (pictureBounds.left! * scale) / 100 + 'px',
          height: (pictureBounds.height! * scale) / 100 + 'px',
          'background-image': foregroundPic ? 'url(' + foregroundPic + '#)' : ''
        }"
      ></div>
    </div>
    <hypetrain-carriage
      *ngFor="let c of carriages; let i = index"
      [viewport]="viewport"
      [size]="c.size"
      [scale]="c.scale"
      [index]="i"
      [pictureBounds]="c.pictureBounds"
      [user]="c.user"
      [backgroundPic]="c.backgroundPic"
      [foregroundPic]="c.foregroundPic"
    >
    </hypetrain-carriage>
  </div>
</div>
